<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<head>
  
  


<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2P5EMX0ZL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-R2P5EMX0ZL');
</script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
  
  
    
      
    
  
  <title>Harvesting your Microsoft 365 SharePoint Site Collections by …</title>
  <meta name="description" content="Getting a complete listing of all the site collections in a tenant using PowerShell or CSOM by Julie Turner" />
<meta name="author" content="Julie Turner"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Veni, Vidi, Vici",
    
    "url": "https:\/\/juliemturner.net\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Veni, Vidi, Vici",
  "url" : "https:\/\/juliemturner.net\/",
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/juliemturner.net\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/juliemturner.net\/post\/harvesting-sharepoint-sites\/",
          "name": "Harvesting your share point site collections"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "author": {
    "@type": "Person",
    "name" : "Julie Turner"
  },
  "headline": "Harvesting your SharePoint Site Collections",
  "description" : "One of the things I’ve been working on lately is harvesting a complete listing of all the site collections in a tenant, including as much metadata as possible. Some of the metadata I’m looking for revolves around adding governance to managing your catalog of sites, especially in a large tenant. For sure I think the SharePoint product group has visibility into the needs here but to get full fidelity might take significantly longer than you can wait.",
  "inLanguage" : "en",
  "wordCount":  1042 ,
  "datePublished" : "2018-03-20T11:36:31",
  "dateModified" : "2018-03-20T11:36:31",
  "image" : "https:\/\/juliemturner.net\/VVV_OG_Image.png",
  "keywords" : [ "Microsoft 365, Microsoft Graph, REST, PowerShell, SharePoint" ],
  "mainEntityOfPage" : "https:\/\/juliemturner.net\/post\/harvesting-sharepoint-sites\/",
  "publisher" : {
    "@type": "Organization",
    "name": "Veni, Vidi, Vici",
    "url" : "https:\/\/juliemturner.net\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/juliemturner.net\/VVV_OG_Image.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>
<meta property="og:url" content="https://juliemturner.net/post/harvesting-sharepoint-sites/" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Harvesting your SharePoint Site Collections" />
<meta property="og:description" content="One of the things I’ve been working on lately is harvesting a complete listing of all the site collections in a tenant, including as much metadata as possible. Some of the metadata I’m looking for revolves around adding governance to managing your catalog of sites, especially in a large tenant. For sure I think the SharePoint product group has visibility into the needs here but to get full fidelity might take significantly longer than you can wait.">
<meta property="og:image" content="https://juliemturner.net/VVV_OG_Image.png" />
<meta property="og:site_name" content="Veni, Vidi, Vici" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta property="twitter:domain" content="julieturner.net">
  <meta property="twitter:url" content="https://juliemturner.net/post/harvesting-sharepoint-sites/">
  <meta name="twitter:title" content="Harvesting your SharePoint Site Collections" />
  <meta name="twitter:description" content="One of the things I’ve been working on lately is harvesting a complete listing of all the site collections in a tenant, including as much metadata as possible. Some of the metadata I’m looking for …">
  <meta name="twitter:image" content="https://juliemturner.net/VVV_OG_Image.png" />
  <meta name="generator" content="Hugo 0.111.3"><link rel="canonical" href="https://juliemturner.net/post/harvesting-sharepoint-sites/">
  <link rel="alternate" href="https://juliemturner.net/index.xml" type="application/rss+xml" title="Veni, Vidi, Vici">

  
  <link rel="stylesheet" href="/sass/main.6773b8d3eb0c22652f9b8b334cc7d1738b1b87e527c955fc4871ca37b0915dab.css" integrity="sha256-Z3O40&#43;sMImUvm4szTMfRc4sbh&#43;UnyVX8SHHKN7CRXas=">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gentium+Plus&display=swap" rel="stylesheet">
  
  
  <link rel="stylesheet" href="https://juliemturner.net/css/syntax.css" />
  


  
</head>

<body>
  <a rel="me" href="https://home.social/@sympjulie"></a>
  <div class="jt-wrapper">
    <header class="jt-header">
      
<nav class="jt-navbar">
    
    <a class="jt-logo" title="Veni, Vidi, Vici" href="https://juliemturner.net/" alt="Julie Turner development blog for Microsoft 365, SharePoint, Teams, and Azure">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 200" role="img">
  <title></title>
  <path
    d="m46.9 133.7.3-12.2c0-24.2-2.2-41.1-6.6-50.5-4.7-9.9-10.4-14.9-17.1-14.9-6.2 0-11.5 3.9-16.2 11.7l-2.4-1.3c6.9-10.8 14.5-16.2 22.8-16.2 19.6 0 29.5 22.5 29.5 67.6l15-23.5c9.1-14.2 13.7-23.1 13.7-26.7 0-1.2-1.4-1.8-4.2-1.8h-3.8l.6-2.9h20.2l-.7 3h-3.9l-42.2 66.6-5 1.1zM135.2 119.7l-.7 3.6c-9.9 6.9-18.4 10.4-25.4 10.4-4.4 0-8-1.6-10.8-4.7-2.8-3.1-4.2-7.1-4.2-12.1 0-8.8 3.4-17.1 10.1-24.9 6.8-7.8 14-11.7 21.6-11.7 2.8 0 5 .9 6.8 2.8 1.7 1.9 2.6 4.3 2.6 7.3 0 6-3.1 11.2-9.2 15.5-6.1 4.3-13.5 6.5-22 6.5v2.1c0 9.1 3.3 13.7 10 13.7 5.9.1 12.9-2.7 21.2-8.5zm-31-10c7-.6 12.5-2.4 16.4-5.4 3.9-3 5.9-7 5.9-11.8 0-4.8-1.7-7.2-5.2-7.2-3.8 0-7.4 2.5-10.9 7.5-3.5 4.9-5.6 10.5-6.2 16.9zM149.4 133.1l3.5-14.5 4.6-23.2c.7-3.6 1.1-5.9 1.1-7 0-1.9-.9-2.9-2.8-2.9-3.1 0-7.7 3.4-14 10.3l.8-4.3c6.8-7.4 13-11.1 18.4-11.1 4.5 0 6.8 2.3 6.8 7 0 1.6-.4 4.3-1.1 8l-2.3 11.6h.7c3.9-8 8.3-14.4 13.3-19.3 4.9-4.9 9.5-7.3 13.8-7.3 5.1 0 7.7 2.8 7.7 8.5 0 1.8-.3 4.1-.8 6.8l-4.6 22.9c-.7 3.6-1.1 6-1.1 7 0 2 .9 3 2.8 3 3.1 0 7.8-3.4 14-10.3l-.9 4.4c-6.8 7.3-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-8l4.6-23c.4-1.8.6-3.3.6-4.5 0-2.5-.9-3.8-2.8-3.8-6 0-14.3 9.5-24.9 28.4l-3.4 16.8-9.9.6zM246.6 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM248 124.3l9.3-6.7 6.9 9.2c-.3 6.3-2.3 11.2-5.9 14.6-3.6 3.4-8.5 5.1-14.7 5.1l2.6-2.9c4.9-.5 7.8-3.8 8.8-9.9l-7-9.4zM348.3 133.7l.3-12.2c0-24.2-2.2-41.1-6.6-50.5-4.7-9.9-10.4-14.9-17.1-14.9-6.1 0-11.5 3.9-16.2 11.7l-2.4-1.3c6.9-10.8 14.5-16.2 22.8-16.2 19.6 0 29.5 22.5 29.5 67.6l15-23.5c9.1-14.2 13.7-23.1 13.7-26.7 0-1.2-1.4-1.8-4.2-1.8h-3.8l.6-2.9h20.2l-.6 2.9h-3.9l-42.2 66.6-5.1 1.2zM427.6 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM468.4 107.1h-.8c-3.6 7.9-7.9 14.3-12.8 19.2-4.9 4.9-9.6 7.4-13.9 7.4-6.6 0-9.9-4.1-9.9-12.4 0-5.6 1.6-11.5 4.9-17.7 3.2-6.2 7.4-11.3 12.6-15.5 3.4-2.8 6.9-4.7 10.3-5.6 3.4-1 8.4-1.4 15-1.4 1.8-6.2 3.8-10.9 5.8-14.2 2-3.3 4.8-6.3 8.4-9.2 6.2-4.9 13-7.3 20.5-7.3 3.1 0 5.9.3 8.4 1l-6.4 6.7c-3.7-1.6-6.9-2.4-9.5-2.4-5 0-8.8 1.8-11.3 5.5-2.5 3.6-4.8 10.5-6.8 20.5l-7.4 37.2c-.8 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.1 0 7.8-3.4 14-10.3l-.9 4.4c-6.8 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.5.4-4.2 1.1-8l2.2-11.8zm3.8-18.8c-3.9-1.8-7.8-2.6-11.7-2.6-5.7 0-10.2 3.6-13.6 10.8-4 8.5-6.1 16.2-6.1 22.9 0 4.9 1.5 7.4 4.4 7.4 2.7 0 6.6-2.8 11.6-8.5 5.1-5.7 9.5-12.1 13.3-19.4l2.1-10.6z" />
  <path
    d="m528 118.3-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM529.4 124.3l9.3-6.7 6.9 9.2c-.3 6.3-2.3 11.2-5.9 14.6-3.6 3.4-8.5 5.1-14.7 5.1l2.6-2.9c4.9-.5 7.8-3.8 8.8-9.9l-7-9.4zM629.6 133.7l.3-12.2c0-24.2-2.2-41.1-6.6-50.5-4.7-9.9-10.4-14.9-17.1-14.9-6.1 0-11.5 3.9-16.2 11.7l-2.4-1.3c6.9-10.8 14.5-16.2 22.8-16.2 19.6 0 29.5 22.5 29.5 67.6l15-23.5c9.1-14.2 13.7-23.1 13.7-26.7 0-1.2-1.4-1.8-4.2-1.8h-3.8l.6-2.9h20.2l-.6 2.9h-3.9l-42.2 66.6-5.1 1.2zM709 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM754 119.6l-.7 3.7c-10.3 6.9-18.7 10.4-25.2 10.4-4.5 0-8.2-1.5-10.9-4.6-2.8-3.1-4.1-7.1-4.1-12.2 0-9.1 3.4-17.5 10.3-25.1 6.9-7.6 14.5-11.4 22.7-11.4 3.6 0 7.2.8 10.8 2.4l-3.1 12.1h-2.9l.1-.7c.3-1.5.5-2.5.5-3.2 0-4.3-2.9-6.5-8.8-6.5-5.5 0-10.1 2.9-13.8 8.8-3.7 5.9-5.5 13.3-5.5 22.1 0 8.5 3.2 12.7 9.5 12.7 6 .1 13.1-2.8 21.1-8.5zM797.7 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4z" />
</svg>
    </a>      
  
  <menu class="jt-nav-links">
    
      
        <li class="jt-nav-item">
          <a title="Blog" href="/">Blog</a>
        </li>
      
    
      
        <li class="jt-nav-item">
          <a title="About" href="/me/">About</a>
        </li>
      
    
      
        <li class="jt-nav-item">
          <a title="Privacy Policy" href="/page/privacy-policy/">Privacy Policy</a>
        </li>
      
    
    
  </menu>
</nav>





<dialog class="hoo-mdldialog-outer">
  <div class="hoo-mdldialog" style="--lqdDialogHeight: 60vh; --lqdDialogWidth: 60vw;">
    <div class="hoo-dlgheader">
      <div class="hoo-dlgheader-title"><h2>Search Veni, Vidi, Vici</h2></div>
      <div class="hoo-dlgheader-closer">
        <button class="hoo-buttonicon" aria-label="Button" onclick="jtBlogMain.hideDialog()">
          <span class="hoo-icon">
            <svg class="hoo-icon-svg icon-close" aria-hidden="true">
                <use xlink:href="/icons.svg#icon-close"></use>
            </svg>
        </span>
        </button>
      </div>
    </div>
    <div class="hoo-dlgcontent">
      <gcse:search></gcse:search>
    </div>
  </div>
</dialog>
      
  
  
  

  
  
  
  
  
  
    
  
  
  
    <div class="jt-article-header" style="background-image: url('harvestingsites.jpeg');">
      
      <div class="jt-post-heading">
        <div class="jt-title">
        <h1>Harvesting your SharePoint Site Collections</h1>
          
          
            <div class="jt-post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on March 20, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1042&nbsp;words
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Julie Turner
    
  
</div>


          
        </div>
      </div>
    </div>
  

    </header>
    <article class="jt-content">      
      
<div class="jt-article" role="main">  
  <article role="main" class="blog-post">
    <p>One of the things I’ve been working on lately is harvesting a complete listing of all the site collections in a tenant, including as much metadata as possible. Some of the metadata I’m looking for revolves around adding governance to managing your catalog of sites, especially in a large tenant. For sure I think the SharePoint product group has visibility into the needs here but to get full fidelity might take significantly longer than you can wait. So, if you’re looking to create yourself a site catalog how do you go about it and what information is available to you. In this post I’m just going to touch on each of the ways you can harvest this information and what additional metadata each provides as well as what other ways you can get information.</p>
<h2 id="site-collection-details---powershell">Site Collection Details - PowerShell</h2>
<p>The SharePoint Online commandlets provide extremely basic information about a site collection through <a href="https://learn.microsoft.com/en-us/powershell/module/sharepoint-online/get-sposite?view=sharepoint-ps">Get-SPOSite</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-SPOSite</span> <span class="n">-Limit</span> <span class="n">All</span> <span class="n">-Detailed</span>
</span></span></code></pre></div><p>Metadata returned</p>
<ul>
<li>ResourceUsageCurrent</li>
<li>ResourceUsageAverage</li>
<li>StorageUsageCurrent</li>
<li>LockIssue</li>
<li>WebsCount</li>
<li>CompatibilityLevel</li>
<li>AllowSelfServiceUpgrade</li>
<li>SiteDefinedSharingCapability - returns the stored value of the site policy.</li>
<li>SharingCapability - returns the effective access level (the site policy and the tenant policy combined.</li>
</ul>
<h2 id="site-collection-details---pnppowershellcsom">Site Collection Details - PnPPowerShell/CSOM</h2>
<p>If the information in the previous call isn’t enough for you or if PowerShell is not really the right language for your solution, then you have the alternative option of SharePoint PnP PowerShell which leverages the Tenant Administration CSOM. For a full list of properties that are returned see the documentation: <a href="https://learn.microsoft.com/en-us/powershell/module/sharepoint-online/Set-SPOSite?view=sharepoint-ps">Powershell</a>/<a href="https://learn.microsoft.com/en-us/previous-versions/office/sharepoint-csom/dn159168(v=office.15)">CSOM</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-PnPTenantSite</span> <span class="n">-Detailed</span>
</span></span></code></pre></div><p>Highlights of the information you can get from this endpoint are…</p>
<ul>
<li>AllowDownloadingNonWebViewableFiles</li>
<li>AllowEditing</li>
<li>CommentsOnSitePagesDisabled</li>
<li>CompatibilityLevel</li>
<li>ConditionalAccessPolicy</li>
<li>DenyAddAndCustomizePages</li>
<li>DisableCompanyWideSharingLinks</li>
<li>DisableFlows</li>
<li>HasHolds</li>
<li>LockIssue</li>
<li>LockState</li>
<li>SharingAllowedDomainList</li>
<li>SharingBlockedDomainList</li>
<li>SharingCapability</li>
<li>SharingDomainRestrictionMode</li>
<li>ShowPeoplePickerSuggestionsForGuestUsers</li>
<li>SiteDefinedSharingCapability</li>
<li>Status</li>
<li>Template</li>
<li>WebsCount</li>
</ul>
<h3 id="under-the-covers-csom">Under the covers… CSOM</h3>
<p>Under the covers of the PnP PowerShell commandlet is CSOM and since it’s open source we can see an example of getting the same information via CSOM, so if you’re writing managed code this might be the better option for you.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Microsoft.Online.SharePoint.TenantManagement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="p">(</span><span class="n">ClientContext</span> <span class="n">ctx</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ClientContext</span><span class="p">(</span><span class="n">tenantUrl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">ctx</span><span class="p">.</span><span class="n">Credentials</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SharePointOnlineCredentials</span><span class="p">(</span><span class="err">\</span><span class="n">_username</span><span class="p">,</span> <span class="err">\</span><span class="n">_password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Tenant</span> <span class="n">tenant</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Tenant</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">SPOSitePropertiesEnumerableFilter</span> <span class="n">filter</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SPOSitePropertiesEnumerableFilter</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">IncludePersonalSite</span> <span class="p">=</span> <span class="n">PersonalSiteFilter</span><span class="p">.</span><span class="n">Exclude</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">StartIndex</span> <span class="p">=</span> <span class="s">&#34;0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">IncludeDetail</span> <span class="p">=</span> <span class="k">true</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">SPOSitePropertiesEnumerable</span> <span class="n">sitesList</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">var</span> <span class="n">sites</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">sitesList</span> <span class="p">=</span> <span class="n">tenant</span><span class="p">.</span><span class="n">GetSitePropertiesFromSharePointByFilters</span><span class="p">(</span><span class="n">filter</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">sitesList</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">sites</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="n">sitesList</span><span class="p">.</span><span class="n">ToList</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">filter</span><span class="p">.</span><span class="n">StartIndex</span> <span class="p">=</span> <span class="n">sitesList</span><span class="p">.</span><span class="n">NextStartIndexFromSharePoint</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">while</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">sitesList</span><span class="p">.</span><span class="n">NextStartIndexFromSharePoint</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="sharing-and-external-users">Sharing and External Users</h2>
<p>One of the things I hear frequently is concerns about managing external access, so having visibility to what sites have external sharing enabled and how many (and which external users) have access us useful. From previous section one of the properties we have access to is ‘SharingCapability’. The possible values for that property are:</p>
<p>Disabled</p>
<p>external user sharing (share by email) and guest link sharing are both disabled</p>
<p>ExternalUserSharingOnly</p>
<p>external user sharing (share by email) is enabled, but guest link sharing is disabled</p>
<p>ExistingExternalUserSharingOnly</p>
<p>(DEFAULT) Allow sharing only with the external users that already exist in your organization’s directory</p>
<p>ExternalUserAndGuestSharing</p>
<p>external user sharing (share by email) and guest link sharing are both enabled</p>
<p>By using the TenantManagement class you can specifically harvest the external users you have in your site collection.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Microsoft.Online.SharePoint.TenantManagement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="p">(</span><span class="n">ClientContext</span> <span class="n">ctx</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ClientContext</span><span class="p">(</span><span class="n">tenantUrl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">ctx</span><span class="p">.</span><span class="n">Credentials</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SharePointOnlineCredentials</span><span class="p">(</span><span class="err">\</span><span class="n">_username</span><span class="p">,</span> <span class="err">\</span><span class="n">_password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kt">var</span> <span class="n">tenant</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Office365Tenant</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kt">var</span> <span class="n">extUsers</span> <span class="p">=</span> <span class="n">tenant</span><span class="p">.</span><span class="n">GetExternalUsersForSite</span><span class="p">(</span><span class="n">siteUrl</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">.</span><span class="n">Ascending</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">ctx</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">extUsers</span><span class="p">,</span> <span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">TotalUserCount</span><span class="p">,</span> <span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">ExternalUserCollection</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kt">var</span> <span class="n">task</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">ctx</span><span class="p">.</span><span class="n">ExecuteQueryAsync</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">task</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">extUsers</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">user</span> <span class="k">in</span> <span class="n">extUsers</span><span class="p">.</span><span class="n">ExternalUserCollection</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">name</span> <span class="p">=</span> <span class="n">user</span><span class="p">.</span><span class="n">DisplayName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">extUsers</span><span class="p">.</span><span class="n">TotalUserCount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="microsoft-graph---whats-available-now">Microsoft Graph - What’s available now</h2>
<p>As the Microsoft Graph is an ever changing API that’s constantly being expanded I’m obviously going to be writing this as a primer as of the date of publication so please make sure you’re referencing the <a href="https://learn.microsoft.com/en-us/graph/overview">graph documentation</a> to verify what might have changed. Of what we have outlined above you can get some very basic information about a site collection from the graph by making a REST call to:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;https://graph.microsoft.com/v1.0/sites/contoso.sharepoint.com:/sites/1drvteam&gt;
</span></span></code></pre></div><p>where &lsquo;contoso.sharepoint.com&rsquo; is your tenant and &lsquo;/sites/1drvteam&rsquo; is the relative path to the site collection you&rsquo;re harvesting.</p>
<blockquote>
<p>There are several other ways to can formulate the call for site information see this <a href="https://learn.microsoft.com/en-us/graph/api/site-get?view=graph-rest-1.0&amp;tabs=http">reference</a> for more details.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;contoso.sharepoint.com,2C712604-1370-44E7-A1F5-426573FDA80A,2D2244C3-251A-49EA-93A8-39E1C3A060FE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;owner&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;displayName&#34;</span><span class="p">:</span> <span class="s2">&#34;Daron Spektor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;5280E7FE-DC7A-4486-9490-E790D81DFEB3&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;displayName&#34;</span><span class="p">:</span> <span class="s2">&#34;OneDrive Team Site&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;1drvteam&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;createdDateTime&#34;</span><span class="p">:</span> <span class="s2">&#34;2017-05-09T20:56:00Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;lastModifiedDateTime&#34;</span><span class="p">:</span> <span class="s2">&#34;2017-05-09T20:56:01Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;webUrl&#34;</span><span class="p">:</span> <span class="s2">&#34;https://contoso.sharepoint.com/teams/1drvteam&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="get-group--by-site-collection-url-sort-of">Get Group – by site collection URL (sort of)</h3>
<p>What might be useful for visibility of your tenant would be information about any group enabled team sites, to get that we can utilize the <strong>/groups</strong> endpoint. For the time being there is no way via the graph to get the related group via the <strong>sites</strong> endpoint. A work around is to use the <strong>$filter</strong> parameter with the <strong>mailNickname</strong> property of the group. For example, if your site collection was <a href="https://contoso.sharepoint.com/teams/1drvteam">https://contoso.sharepoint.com/teams/1drvteam</a> then the corresponding graph call to get the group information would be:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://graph.microsoft.com/v1.0/groups?$filter=mailNickname eq &#39;1drvteam&#39;
</span></span></code></pre></div><p>which then returns the following properties and extensions</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;allowExternalSenders&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;autoSubscribeNewMembers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;createdDateTime&#34;</span><span class="p">:</span> <span class="s2">&#34;String (timestamp)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;displayName&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;groupTypes&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span><span class="s2">&#34;string&#34;</span><span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;string (identifier)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;isSubscribedByMail&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;mail&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;mailEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;mailNickname&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;onPremisesLastSyncDateTime&#34;</span><span class="p">:</span> <span class="s2">&#34;String (timestamp)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;onPremisesSecurityIdentifier&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;onPremisesSyncEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;proxyAddresses&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span><span class="s2">&#34;string&#34;</span><span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;renewedDateTime&#34;</span><span class="p">:</span> <span class="s2">&#34;String (timestamp)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;securityEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;unseenCount&#34;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;visibility&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;acceptedSenders&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.directoryObject&#34;</span><span class="p">}</span> <span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;calendar&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.calendar&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;calendarView&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.event&#34;</span> <span class="p">}</span><span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;conversations&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.conversation&#34;</span> <span class="p">}</span><span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;createdOnBehalfOf&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.directoryObject&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;drive&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.drive&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;events&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.event&#34;</span> <span class="p">}</span><span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;memberOf&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.directoryObject&#34;</span> <span class="p">}</span> <span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;members&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.directoryObject&#34;</span> <span class="p">}</span> <span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;owners&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.directoryObject&#34;</span> <span class="p">}</span> <span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;photo&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.profilePhoto&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;rejectedSenders&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.directoryObject&#34;</span> <span class="p">}</span> <span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;sites&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.site&#34;</span> <span class="p">}</span> <span class="err">\</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;threads&#34;</span><span class="p">:</span> <span class="err">\</span><span class="p">[</span> <span class="p">{</span> <span class="nt">&#34;@odata.type&#34;</span><span class="p">:</span> <span class="s2">&#34;microsoft.graph.conversationThread&#34;</span> <span class="p">}</span><span class="err">\</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Now you have the group’s guid, you can formalize the call to</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://graph.microsoft.com/v1.0/groups/54e79fa1-0948-4a98-9914-199230818f49
</span></span></code></pre></div><p>And then get other related group information including those outlined in the response above. Included in the members endpoint is the <strong>userPrincipalName</strong>, in the case of external users this property will have the <strong>#Ext#</strong> pattern, and therefore could be used to determine if there are external users in the group. That said it&rsquo;s a much more round about method then the properties you got from the TenantAdministration CSOM call detailed in the previous section.</p>

  </article>

      
    
    <div class="jt-pager">
      
        <button class="hoo-button" title="Conquer your dev toolchain in &#39;Classic&#39; SharePoint – Part 4" onclick="jtBlogMain.navigate('https:\/\/juliemturner.net\/post\/conquer-your-dev-toolchain-4\/')" > 
          <span class="hoo-icon">
            <svg class="hoo-icon-svg icon-arrow-left" aria-hidden="true">
              <use xlink:href="/icons.svg#icon-arrow-left"></use>
            </svg>
          </span>
          <span class="hoo-button-label">Previous Post</span>      
        </button>
      
      
        <button class="hoo-button is-reversed" title="Managing the Unified Group in Office 365 for SharePoint and Beyond" onclick="jtBlogMain.navigate('https:\/\/juliemturner.net\/post\/managing-unifed-group\/')">
          <span class="hoo-icon">
            <svg class="hoo-icon-svg icon-arrow-right" aria-hidden="true">
              <use xlink:href="/icons.svg#icon-arrow-right"></use>
            </svg>
          </span>
          <span class="hoo-button-label">Next Post</span>
        </button>
      
    </div>
  

  
    
      
      <div class="jt-disqus-comments">                  
        <button onclick="jtBlogMain.showComments(event, 'veni-vidi-vici-1')">
          Show 
          <span class="disqus-comment-count" data-disqus-url="https://juliemturner.net/post/harvesting-sharepoint-sites/">comments</span>
        </button>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_config = function () {
          this.page.url = 'https:\/\/juliemturner.net\/post\/harvesting-sharepoint-sites';
        };
      </script>
      </div>
      
    
  
</div>

    </article>
    <aside class="jt-sidebar">
      

  <div class="jt-asideSection">
    
<h2>Share this post</h2>

<ul class="hoo-meta-list">
  
  <li>
    <a class="hoo-mtag" href="//twitter.com/share?url=https%3a%2f%2fjuliemturner.net%2fpost%2fharvesting-sharepoint-sites%2f&amp;text=Harvesting%20your%20SharePoint%20Site%20Collections&amp;via=jfj1997"
      target="_blank" title="Share on Twitter">
      <i class="fab fa-twitter jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjuliemturner.net%2fpost%2fharvesting-sharepoint-sites%2f" target="_blank" title="Share on Facebook">
      <i class="fab fa-facebook jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//reddit.com/submit?url=https%3a%2f%2fjuliemturner.net%2fpost%2fharvesting-sharepoint-sites%2f&amp;title=Harvesting%20your%20SharePoint%20Site%20Collections" target="_blank" title="Share on Reddit">
      <i class="fab fa-reddit jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fjuliemturner.net%2fpost%2fharvesting-sharepoint-sites%2f&amp;title=Harvesting%20your%20SharePoint%20Site%20Collections" target="_blank"
      title="Share on LinkedIn">
      <i class="fab fa-linkedin jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//toot.kytta.dev/?text=Check%20out%20this%20article%20Harvesting%20your%20SharePoint%20Site%20Collections%20at%20https%3a%2f%2fjuliemturner.net%2fpost%2fharvesting-sharepoint-sites%2f" target="_blank"
      title="Share on Mastodon">
      <i class="fab fa-mastodon jt-mtag-icon"></i>
    </a>
  </li>
</ul>

  </div>




  <div class="jt-asideSection">
    <h2>Tags</h2>
    <ul class="hoo-meta-list">
  
  <li>
    <a class="hoo-mtag" href="/tags/microsoft-365/" aria-label="View all posts tagged with 'Microsoft 365'">
      <span class="hoo-mtag-lbl">Microsoft 365</span>
    </a>
  </li>
  
  <li>
    <a class="hoo-mtag" href="/tags/microsoft-graph/" aria-label="View all posts tagged with 'Microsoft Graph'">
      <span class="hoo-mtag-lbl">Microsoft Graph</span>
    </a>
  </li>
  
  <li>
    <a class="hoo-mtag" href="/tags/rest/" aria-label="View all posts tagged with 'REST'">
      <span class="hoo-mtag-lbl">REST</span>
    </a>
  </li>
  
  <li>
    <a class="hoo-mtag" href="/tags/powershell/" aria-label="View all posts tagged with 'PowerShell'">
      <span class="hoo-mtag-lbl">PowerShell</span>
    </a>
  </li>
  
  <li>
    <a class="hoo-mtag" href="/tags/sharepoint/" aria-label="View all posts tagged with 'SharePoint'">
      <span class="hoo-mtag-lbl">SharePoint</span>
    </a>
  </li>
  
</ul>
  </div>


  
    
  
  
    <div class="jt-asideSection">
      <h2>See also</h2>
      <ul class="symp-list">
      
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/htwoo-210-dialogs/">hTWOo-React 2.1.0 Spotlight: Dialogs</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/better-practices-console-log-pnpjs/">Console Log Better Practices with PnPjs V3</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/intro-htwoo-react/">Intro to hTWOo-React: Microsoft Fluent UI React alternative</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/getting-started-pnpjs/">Getting Started with PnPjs</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/sp-appcatalog-dev-tips/">SharePoint App Catalog Development Tips</a></li>
      
      </ul>
    </div>
  

<div class="jt-asideSection">
  <h2>About the Author</h2>
  <div class="jt-aside-headshot">
    <img src="https://juliemturner.net/img/jturner.png" alt="Julie Turner headshot" />
  </div>
  <div class="jt-highlight">Julie Turner</div>
  <div class="jt-subhighlight">Partner/CTO</div>
  <div class="jt-subhighlight">
    <a href="https://sympraxisconsulting.com" target="_blank">
      <div class="symp-logo"></div>
    </a>
  </div>
  <div class="jt-listcont">
    <ul class="symp-list">
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span>Microsoft MVP since 2017</li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://pnp.github.io/" target="_blank">Microsoft 365 PnP Team member since 2019</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://pnp.github.io/pnpjs/" target="_blank">PnPjs maintainer</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://lab.n8d.studio/htwoo/" target="_blank">HTWOO maintainer</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://sympraxisconsulting.com/portfolio/clouddev-clarity/" target="_blank">CloudDev Clarity co-host</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://officedev.github.io/browser-native/" target="_blank">Browser Native co-host</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://sympraxisconsulting.com/ask-sympraxis/" target="_blank">Ask Sympraxis Bi-Weekly Videocast</a></li>
    </ul>
  </div>
</div>

  <div class="jt-asideSection">
  <h2>Join Me Live</h2>
   
    
    
   
    
    
   
    
    
   
    
    
   
    
    
  
</div>


    </aside>
    <footer class="footer">
      
        <ul class="hoo-meta-list">
          
          <li>
            
              <a href="mailto:julie.turner@sympraxisconsulting.com"
                title="Email me">
                
                <span class="fa-stack fa-lg">
                  <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://github.com/juliemturner"
                title="GitHub">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://twitter.com/jfj1997"
                title="Twitter">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://linkedin.com/in/juliemturner"
                title="LinkedIn">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://www.youtube.com/user/username"
                title="Youtube">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
            <a rel="me"href="#ZgotmplZ"
              title="Mastodon">
              
                <span class="fa-stack fa-lg">
                  <i class="fab fa-mastodon fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          
            
          
        </ul>
        <p class="jt-copyright">
          &nbsp;&copy;
          2011 - 2023
          Julie Turner ~ All rights reserved
        </p>


<script src="https://juliemturner.net/js/solid.min.js"></script>
<script src="https://juliemturner.net/js/brands.min.js"></script>
<script src="https://juliemturner.net/js/fontawesome.min.js"></script>

<script src="https://juliemturner.net/js/main.js"></script>





<script id="dsq-count-scr" src="//veni-vidi-vici-1.disqus.com/count.js" async></script>


      
    </footer>
  </div>
</body>

</html>