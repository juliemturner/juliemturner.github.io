<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<head>
  
  


<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2P5EMX0ZL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-R2P5EMX0ZL');
</script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
  
  
  <title>Managing the Unified Group in Office 365 for SharePoint and …</title>
  <meta name="description" content="Introduction Azure Active Directory (AAD) Unified Groups, or better known as Office365 Groups, the security principal that underlies modern SharePoint team …" />
<meta name="author" content="Julie Turner"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Veni, Vidi, Vici",
    
    "url": "https:\/\/juliemturner.net\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Veni, Vidi, Vici",
  "url" : "https:\/\/juliemturner.net\/",
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/juliemturner.net\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/juliemturner.net\/post\/managing-unifed-group\/",
          "name": "Managing the unified group in office 365 for share point and beyond"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "author": {
    "@type": "Person",
    "name" : "Julie Turner"
  },
  "headline": "Managing the Unified Group in Office 365 for SharePoint and Beyond",
  "description" : "Introduction Azure Active Directory (AAD) Unified Groups, or better known as Office365 Groups, the security principal that underlies modern SharePoint team sites, Teams, Outlook Groups, Planner, etc. is a very powerful management construct that is the glue that holds the Office 365 security pyramid together. Basically, a Unified Group has both an Owners group and a Members group and by adding users (either users in your tenant or external users – with a Microsoft based work and school account or a personal account) you can create a construct that allows you to work across many of the vast product offerings in Office 365.",
  "inLanguage" : "en",
  "wordCount":  2174 ,
  "datePublished" : "2018-04-10T13:24:04",
  "dateModified" : "2018-04-10T13:24:04",
  "image" : "https:\/\/juliemturner.net\/VVV_OG_Image.png",
  "keywords" : [ "SharePoint, Microsoft 365, C#" ],
  "mainEntityOfPage" : "https:\/\/juliemturner.net\/post\/managing-unifed-group\/",
  "publisher" : {
    "@type": "Organization",
    "name": "Veni, Vidi, Vici",
    "url" : "https:\/\/juliemturner.net\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/juliemturner.net\/VVV_OG_Image.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>
<meta property="og:url" content="https://juliemturner.net/post/managing-unifed-group/" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Managing the Unified Group in Office 365 for SharePoint and Beyond" />
<meta property="og:description" content="Introduction Azure Active Directory (AAD) Unified Groups, or better known as Office365 Groups, the security principal that underlies modern SharePoint team sites, Teams, Outlook Groups, Planner, etc. is a very powerful management construct that is the glue that holds the Office 365 security pyramid together. Basically, a Unified Group has both an Owners group and a Members group and by adding users (either users in your tenant or external users – with a Microsoft based work and school account or a personal account) you can create a construct that allows you to work across many of the vast product offerings in Office 365.">
<meta property="og:image" content="https://juliemturner.net/VVV_OG_Image.png" />
<meta property="og:site_name" content="Veni, Vidi, Vici" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta property="twitter:domain" content="julieturner.net">
  <meta property="twitter:url" content="https://juliemturner.net/post/managing-unifed-group/">
  <meta name="twitter:title" content="Managing the Unified Group in Office 365 for SharePoint and Beyond" />
  <meta name="twitter:description" content="Introduction Azure Active Directory (AAD) Unified Groups, or better known as Office365 Groups, the security principal that underlies modern SharePoint team sites, Teams, Outlook Groups, Planner, etc. …">
  <meta name="twitter:image" content="https://juliemturner.net/VVV_OG_Image.png" />
  <meta name="generator" content="Hugo 0.111.3"><link rel="canonical" href="https://juliemturner.net/post/managing-unifed-group/">
  <link rel="alternate" href="https://juliemturner.net/index.xml" type="application/rss+xml" title="Veni, Vidi, Vici">

  
  <link rel="stylesheet" href="/sass/main.6773b8d3eb0c22652f9b8b334cc7d1738b1b87e527c955fc4871ca37b0915dab.css" integrity="sha256-Z3O40&#43;sMImUvm4szTMfRc4sbh&#43;UnyVX8SHHKN7CRXas=">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gentium+Plus&display=swap" rel="stylesheet">
  
  
  <link rel="stylesheet" href="https://juliemturner.net/css/syntax.css" />
  


  
</head>

<body>
  <a rel="me" href="https://home.social/@sympjulie"></a>
  <div class="jt-wrapper">
    <header class="jt-header">
      
<nav class="jt-navbar">
    
    <a class="jt-logo" title="Veni, Vidi, Vici" href="https://juliemturner.net/" alt="Julie Turner development blog for Microsoft 365, SharePoint, Teams, and Azure">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 200" role="img">
  <title></title>
  <path
    d="m46.9 133.7.3-12.2c0-24.2-2.2-41.1-6.6-50.5-4.7-9.9-10.4-14.9-17.1-14.9-6.2 0-11.5 3.9-16.2 11.7l-2.4-1.3c6.9-10.8 14.5-16.2 22.8-16.2 19.6 0 29.5 22.5 29.5 67.6l15-23.5c9.1-14.2 13.7-23.1 13.7-26.7 0-1.2-1.4-1.8-4.2-1.8h-3.8l.6-2.9h20.2l-.7 3h-3.9l-42.2 66.6-5 1.1zM135.2 119.7l-.7 3.6c-9.9 6.9-18.4 10.4-25.4 10.4-4.4 0-8-1.6-10.8-4.7-2.8-3.1-4.2-7.1-4.2-12.1 0-8.8 3.4-17.1 10.1-24.9 6.8-7.8 14-11.7 21.6-11.7 2.8 0 5 .9 6.8 2.8 1.7 1.9 2.6 4.3 2.6 7.3 0 6-3.1 11.2-9.2 15.5-6.1 4.3-13.5 6.5-22 6.5v2.1c0 9.1 3.3 13.7 10 13.7 5.9.1 12.9-2.7 21.2-8.5zm-31-10c7-.6 12.5-2.4 16.4-5.4 3.9-3 5.9-7 5.9-11.8 0-4.8-1.7-7.2-5.2-7.2-3.8 0-7.4 2.5-10.9 7.5-3.5 4.9-5.6 10.5-6.2 16.9zM149.4 133.1l3.5-14.5 4.6-23.2c.7-3.6 1.1-5.9 1.1-7 0-1.9-.9-2.9-2.8-2.9-3.1 0-7.7 3.4-14 10.3l.8-4.3c6.8-7.4 13-11.1 18.4-11.1 4.5 0 6.8 2.3 6.8 7 0 1.6-.4 4.3-1.1 8l-2.3 11.6h.7c3.9-8 8.3-14.4 13.3-19.3 4.9-4.9 9.5-7.3 13.8-7.3 5.1 0 7.7 2.8 7.7 8.5 0 1.8-.3 4.1-.8 6.8l-4.6 22.9c-.7 3.6-1.1 6-1.1 7 0 2 .9 3 2.8 3 3.1 0 7.8-3.4 14-10.3l-.9 4.4c-6.8 7.3-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-8l4.6-23c.4-1.8.6-3.3.6-4.5 0-2.5-.9-3.8-2.8-3.8-6 0-14.3 9.5-24.9 28.4l-3.4 16.8-9.9.6zM246.6 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM248 124.3l9.3-6.7 6.9 9.2c-.3 6.3-2.3 11.2-5.9 14.6-3.6 3.4-8.5 5.1-14.7 5.1l2.6-2.9c4.9-.5 7.8-3.8 8.8-9.9l-7-9.4zM348.3 133.7l.3-12.2c0-24.2-2.2-41.1-6.6-50.5-4.7-9.9-10.4-14.9-17.1-14.9-6.1 0-11.5 3.9-16.2 11.7l-2.4-1.3c6.9-10.8 14.5-16.2 22.8-16.2 19.6 0 29.5 22.5 29.5 67.6l15-23.5c9.1-14.2 13.7-23.1 13.7-26.7 0-1.2-1.4-1.8-4.2-1.8h-3.8l.6-2.9h20.2l-.6 2.9h-3.9l-42.2 66.6-5.1 1.2zM427.6 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM468.4 107.1h-.8c-3.6 7.9-7.9 14.3-12.8 19.2-4.9 4.9-9.6 7.4-13.9 7.4-6.6 0-9.9-4.1-9.9-12.4 0-5.6 1.6-11.5 4.9-17.7 3.2-6.2 7.4-11.3 12.6-15.5 3.4-2.8 6.9-4.7 10.3-5.6 3.4-1 8.4-1.4 15-1.4 1.8-6.2 3.8-10.9 5.8-14.2 2-3.3 4.8-6.3 8.4-9.2 6.2-4.9 13-7.3 20.5-7.3 3.1 0 5.9.3 8.4 1l-6.4 6.7c-3.7-1.6-6.9-2.4-9.5-2.4-5 0-8.8 1.8-11.3 5.5-2.5 3.6-4.8 10.5-6.8 20.5l-7.4 37.2c-.8 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.1 0 7.8-3.4 14-10.3l-.9 4.4c-6.8 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.5.4-4.2 1.1-8l2.2-11.8zm3.8-18.8c-3.9-1.8-7.8-2.6-11.7-2.6-5.7 0-10.2 3.6-13.6 10.8-4 8.5-6.1 16.2-6.1 22.9 0 4.9 1.5 7.4 4.4 7.4 2.7 0 6.6-2.8 11.6-8.5 5.1-5.7 9.5-12.1 13.3-19.4l2.1-10.6z" />
  <path
    d="m528 118.3-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM529.4 124.3l9.3-6.7 6.9 9.2c-.3 6.3-2.3 11.2-5.9 14.6-3.6 3.4-8.5 5.1-14.7 5.1l2.6-2.9c4.9-.5 7.8-3.8 8.8-9.9l-7-9.4zM629.6 133.7l.3-12.2c0-24.2-2.2-41.1-6.6-50.5-4.7-9.9-10.4-14.9-17.1-14.9-6.1 0-11.5 3.9-16.2 11.7l-2.4-1.3c6.9-10.8 14.5-16.2 22.8-16.2 19.6 0 29.5 22.5 29.5 67.6l15-23.5c9.1-14.2 13.7-23.1 13.7-26.7 0-1.2-1.4-1.8-4.2-1.8h-3.8l.6-2.9h20.2l-.6 2.9h-3.9l-42.2 66.6-5.1 1.2zM709 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4zM754 119.6l-.7 3.7c-10.3 6.9-18.7 10.4-25.2 10.4-4.5 0-8.2-1.5-10.9-4.6-2.8-3.1-4.1-7.1-4.1-12.2 0-9.1 3.4-17.5 10.3-25.1 6.9-7.6 14.5-11.4 22.7-11.4 3.6 0 7.2.8 10.8 2.4l-3.1 12.1h-2.9l.1-.7c.3-1.5.5-2.5.5-3.2 0-4.3-2.9-6.5-8.8-6.5-5.5 0-10.1 2.9-13.8 8.8-3.7 5.9-5.5 13.3-5.5 22.1 0 8.5 3.2 12.7 9.5 12.7 6 .1 13.1-2.8 21.1-8.5zM797.7 118.3l-.8 4.4c-6.9 7.4-13 11-18.4 11-4.5 0-6.8-2.4-6.8-7.1 0-1.6.4-4.2 1.1-7.9l3.2-16.3c.9-4.6 1.3-7.7 1.3-9.2 0-2.6-1-3.9-3.1-3.9-1.4 0-3.9.5-7.6 1.6l.6-2.9 22.9-7.5-3.6 15-4.6 23.2c-.7 3.6-1.1 5.9-1.1 6.9 0 2 .9 3.1 2.8 3.1 3.2 0 7.9-3.5 14.1-10.4zm-17.2-46 3.1-6.4 13.2-8.6-4 8.6-12.3 6.4z" />
</svg>
    </a>      
  
  <menu class="jt-nav-links">
    
      
        <li class="jt-nav-item">
          <a title="Blog" href="/">Blog</a>
        </li>
      
    
      
        <li class="jt-nav-item">
          <a title="About" href="/me/">About</a>
        </li>
      
    
      
        <li class="jt-nav-item">
          <a title="Privacy Policy" href="/page/privacy-policy/">Privacy Policy</a>
        </li>
      
    
    
  </menu>
</nav>





<dialog class="hoo-mdldialog-outer">
  <div class="hoo-mdldialog" style="--lqdDialogHeight: 60vh; --lqdDialogWidth: 60vw;">
    <div class="hoo-dlgheader">
      <div class="hoo-dlgheader-title"><h2>Search Veni, Vidi, Vici</h2></div>
      <div class="hoo-dlgheader-closer">
        <button class="hoo-buttonicon" aria-label="Button" onclick="jtBlogMain.hideDialog()">
          <span class="hoo-icon">
            <svg class="hoo-icon-svg icon-close" aria-hidden="true">
                <use xlink:href="/icons.svg#icon-close"></use>
            </svg>
        </span>
        </button>
      </div>
    </div>
    <div class="hoo-dlgcontent">
      <gcse:search></gcse:search>
    </div>
  </div>
</dialog>
      
  
  
  

  
  
  
  
  
  
    
  
  
  
    <div class="jt-article-header" style="background-image: url('ManagingUnifiedGroup_lg.png');">
      
      <div class="jt-post-heading">
        <div class="jt-title">
        <h1>Managing the Unified Group in Office 365 for SharePoint and Beyond</h1>
          
          
            <div class="jt-post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on April 10, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;11&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;2174&nbsp;words
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Julie Turner
    
  
</div>


          
        </div>
      </div>
    </div>
  

    </header>
    <article class="jt-content">      
      
<div class="jt-article" role="main">  
  <article role="main" class="blog-post">
    <h2 id="introduction">Introduction</h2>
<p>Azure Active Directory (AAD) Unified Groups, or better known as Office365 Groups, the security principal that underlies modern SharePoint team sites, Teams, Outlook Groups, Planner, etc. is a very powerful management construct that is the glue that holds the Office 365 security pyramid together. Basically, a Unified Group has both an Owners group and a Members group and by adding users (either users in your tenant or external users – with a Microsoft based work and school account or a personal account) you can create a construct that allows you to work across many of the vast product offerings in Office 365. For a more easily consumable infographic covering the power of Unified Groups go check out fellow MVP, <a href="https://twitter.com/thatmattwade">Matt Wade’s</a> <a href="https://icansharepoint.com/everyday-guide-office-365-groups/"><em>An everyday guild to Office 365 Groups</em></a></p>
<p>At the tenant level, weather you’ve thought about it or not, you have a default sharing status for all the Unified Groups in your environment. Assuming you haven’t changed anything, they are probably; “Let users add new guests to the organization” and then for SharePoint and OneDrive “Let users share SharePoint Online and OneDrive for Business content with people outside the organization” – “Anyone, including anonymous users”. Obviously, you can set these any way you like but assuming you want to allow sharing of some kind then you’ll need to have sharing enabled at the tenant level. So now how do you disable/enable sharing for each of the groups/site collections.</p>
<p>Long story short, if you’re an enterprise you might want the ability to manage which groups include users outside your organization. And you might even want to build a system for tracking what users are granted access and if there’s some sort of approval process in place. By flipping a lot of switches and twisting a bunch of knobs, most through the Microsoft Graph and somewhat through the Microsoft.TenantAdministration library you can achieve just that.</p>
<h2 id="scenario">Scenario</h2>
<p>From a central management system, maintain a list of sites a partner has external access to and the names of each user from that partner with access.* When a new site/user is added do the following:</p>
<ol>
<li>manually add that user as an external user via invitation in AAD</li>
<li>modify their user properties</li>
<li>assign them a manager</li>
<li>add the new user to the member group of the Unified Group</li>
</ol>
<p>When the user accepts the external sharing request they will have access to the group. Further, we want to maintain one entry in AAD for each external email account.</p>
<blockquote>
<p>For the purposes of this scenario I’m not discussing the architecture of said central management system suffice it to say it certainly could be a set of lists in SharePoint with a relationship on partner, but it also could be an external system built on top of a relational database. Regardless of this implementation let’s assume we have a source of partners and users that can be granted access.</p>
</blockquote>
<h2 id="implementation">Implementation</h2>
<p>With the assumption that you are familiar with creating an Azure AD Application (either v1 of v2), the various authentication flows that you could use depending on your platform du jour, and the various ways to use either the ADAL or MSAL libraries I’ll move on to the actual pieces of code that implement the solution. If you are not familiar, please start by checking out the documentation about how to get auth tokens from the official <a href="https://learn.microsoft.com/en-us/graph/auth/?view=graph-rest-1.0">Microsoft site</a>. That site also has a bunch of Quick Starts and if you like labs, there are some good Microsoft Graph <a href="https://github.com/OfficeDev/TrainingContent/tree/master/Graph">Hands On Labs</a> you can use to get yourself up to speed.</p>
<p>Also, when creating your Azure Application, you will need to grant a bunch of permissions depending on what type of app registration you choose. Because I am using application permissions and not delegated permissions, I granted my application the following:</p>
<ul>
<li>Directory.Read.All</li>
<li>Directory.ReadWrite.All</li>
<li>Group.ReadWrite.All</li>
<li>User.Invite.All</li>
<li>User.ReadWrite.All</li>
</ul>
<h3 id="setup">Setup</h3>
<p>Assuming you have a list of sites you want to enable sharing with for each site you will need the site’s URL and the corresponding O365 Unified Group ‘Id’. I explained in my <a href="/post/harvesting-sharepoint-sites/">previous post</a> how you might use the Microsoft Graph to retrieve the ID if you know the site URL. Since we have to have &ldquo;sharing&rdquo; turned on at the tenant level you will most likely want a process in place that turns sharing off for all existing Unified Groups and site collections and any newly created ones, managing that is outside the scope of this post but the code would be the same.</p>
<blockquote>
<p>I have seen several instances where that scenario won’t work but I’m almost positive it’s legacy groups that were created in this tenant as a result of utilizing preview code… so for the purposes of this post I’m going to assume you can get the Id via graph but if not, there are other ways you can get it most notably the Exchange Online PowerShell comandlets. You can use <a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-unifiedgroup?view=exchange-ps">Get-UnifiedGroup</a> to retrieve information about the group. Be aware an entirely confusing aspect of the results of the commandlet is knowing which of the various guid’s returned is the one that works consistently with the Microsoft Graph. I have found that the <strong>ExternalDirectoryObjectId</strong> property works most consistently but have found several instances where it’s null, and in that case the ID seems to be the best alternative.</p>
</blockquote>
<h3 id="manage-sharing-of-unified-group">Manage Sharing of Unified Group</h3>
<p>To enable or disable sharing of the Unified Group, which is different from the site collection sharing status, you will want to create and apply a particular <strong>groupSettingTemplate</strong> to the Unified Group. You do so by first creating your version of the <strong>Group.Unified.Guest</strong> template. You can get the id of this template by issuing the following get request using the <a href="https://developer.microsoft.com/en-us/graph/graph-explorer">graph explorer</a>: <em><a href="https://graph.microsoft.com/v1.0/groupSettingTemplates">https://graph.microsoft.com/v1.0/groupSettingTemplates</a></em></p>
<p>If you scroll through the results you will find the template for ‘Group.Unified.Guest’. Note the templates Id. Based on my testing the id is the same in all tenants, so you can probably skip this test but if you have problems might be worth going back and checking. Ok, now what you want to do is create the content for your request, check if the template is already applied to the group in question and then either post or patch the template to the group. See the code below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">//URL to the group&#39;s settings</span>
</span></span><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">urlGraph</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;https://graph.microsoft.com/v1.0/groups/{0}/settings&#34;</span><span class="p">,</span> <span class="n">groupId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//The groupSettingsTemplate Id that we want to apply to our group</span>
</span></span><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">templateId</span> <span class="p">=</span> <span class="s">&#34;08d542b9-071f-4e16-94b0-74abb372e3d9&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//The version of the template we will apply to the group, where AllowToAddGuests is either true/false</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StringContent</span><span class="p">(</span><span class="s">@&#34;{
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;displayName&#39;: &#39;Group.Unified.Guest&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;templateId&#39;: &#39;08d542b9-071f-4e16-94b0-74abb372e3d9&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;values&#39;: [
</span></span></span><span class="line"><span class="cl"><span class="s">        {
</span></span></span><span class="line"><span class="cl"><span class="s">        &#39;name&#39;: &#39;AllowToAddGuests&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">        &#39;value&#39;: &#39;True&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">        }
</span></span></span><span class="line"><span class="cl"><span class="s">    ]
</span></span></span><span class="line"><span class="cl"><span class="s">}&#39;}&#34;</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">&#34;application/json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//setup client</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Accept</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Accept</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">MediaTypeWithQualityHeaderValue</span><span class="p">(</span><span class="s">&#34;application/json&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//A previous Async request retrieved our access token, now we&#39;re appending it to the header</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;Authorization&#34;</span><span class="p">,</span> <span class="s">&#34;Bearer &#34;</span> <span class="p">+</span> <span class="n">task</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//Check if template exists</span>
</span></span><span class="line"><span class="cl">    <span class="kt">string</span> <span class="n">settingId</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Gets a list of existing groupTemplates applied to the group, if any.</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">taskExists</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">GetAsync</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">taskExists</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">taskExists</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">taskExists</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="n">taskExists</span><span class="p">.</span><span class="n">Result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">taskResponse</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">taskResponse</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">taskResponse</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//Converting the results to an object we can consume in C#, this is done by creating a class that matches the JSON</span>
</span></span><span class="line"><span class="cl">                <span class="n">GroupSettingsList</span> <span class="n">settings</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">GroupSettingsList</span><span class="p">&gt;(</span><span class="n">taskResponse</span><span class="p">.</span><span class="n">Result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="k">value</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">setting</span> <span class="k">in</span> <span class="n">settings</span><span class="p">.</span><span class="k">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="c1">//If the current setting, matches the groupSettingTemplate then save it</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="p">(</span><span class="n">setting</span><span class="p">.</span><span class="n">templateId</span> <span class="p">==</span> <span class="n">templateId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                            <span class="n">settingId</span> <span class="p">=</span> <span class="n">settings</span><span class="p">.</span><span class="k">value</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">Task</span><span class="p">&lt;</span><span class="n">HttpResponseMessage</span><span class="p">&gt;</span> <span class="n">taskResult</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Based on if the groupSettingTemplate is already applied to this group, either post a new one or patch the existing one</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">settingId</span> <span class="p">==</span> <span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">taskResult</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">PostAsync</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">,</span> <span class="n">content</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="n">taskResult</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">PatchAsync</span><span class="p">(</span><span class="n">urlGraph</span> <span class="p">+</span> <span class="s">&#34;/&#34;</span> <span class="p">+</span> <span class="n">settingId</span><span class="p">,</span> <span class="n">content</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">taskResult</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">taskResult</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">taskResult</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">Created</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Success&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="manage-sharing-of-the-sharepoint-site-collection">Manage Sharing of the SharePoint site collection</h3>
<p>Unfortunately, there is (as of publishing) no way through the Microsoft Graph to modify the sharing status of the site collection, however you can easily do so through CSOM. The Microsoft.TenantAdministration library gives you the means to change to the following states through an enum: <em>Disabled, ExternalUserSharingOnly, ExternalUserAndGuestSharing, ExistingExternalUserSharingOnly</em>. The following code shows you how to change it from <strong>Disabled</strong> to <strong>ExternalUserSharingOnly</strong> based on a value passed to the function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">//Note this specific using for the &#39;Tenant&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Microsoft.Online.SharePoint.TenantAdministration</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="p">(</span><span class="n">ClientContext</span> <span class="n">ctx</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ClientContext</span><span class="p">(</span><span class="n">tenantUrl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">Credentials</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SharePointOnlineCredentials</span><span class="p">(</span><span class="err">\</span><span class="n">_username</span><span class="p">,</span> <span class="err">\</span><span class="n">_password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">RequestTimeout</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Tenant</span> <span class="n">tenant</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Tenant</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">site</span> <span class="p">=</span> <span class="n">tenant</span><span class="p">.</span><span class="n">GetSitePropertiesByUrl</span><span class="p">(</span><span class="n">siteUrl</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">site</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">taskResult</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">ctx</span><span class="p">.</span><span class="n">ExecuteQueryAsync</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">taskResult</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">site</span><span class="p">.</span><span class="n">SharingCapability</span> <span class="p">=</span> <span class="n">sharingEnabled</span> <span class="p">?</span> <span class="n">SharingCapabilities</span><span class="p">.</span><span class="n">ExternalUserSharingOnly</span> <span class="p">:</span> <span class="n">SharingCapabilities</span><span class="p">.</span><span class="n">Disabled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//A list of allowed external domains can be added here</span>
</span></span><span class="line"><span class="cl">    <span class="n">site</span><span class="p">.</span><span class="n">SharingAllowedDomainList</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">SpoOperation</span> <span class="n">op</span> <span class="p">=</span> <span class="n">site</span><span class="p">.</span><span class="n">Update</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">IsComplete</span><span class="p">,</span> <span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">PollingInterval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(!</span><span class="n">op</span><span class="p">.</span><span class="n">IsComplete</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//wait 15 seconds and try again</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">15000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">op</span><span class="p">.</span><span class="n">RefreshLoad</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">ctx</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="creating-external-users">Creating External Users</h3>
<p>If the external user’s account already exists in your AAD, you will need to retrieve the users AAD id which can be accomplished by making a call to the user endpoint as shown below. This code is also the basis as you can see by the comments for adding the existing or newly created user to the Unified Group.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">//Url to verify if external user already exists</span>
</span></span><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">urlGraph</span> <span class="p">=</span> <span class="s">&#34;https://graph.microsoft.com/v1.0/users?$filter=mail eq &#39;my\_email@extdomain.com&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//setup client</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Accept</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Accept</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">MediaTypeWithQualityHeaderValue</span><span class="p">(</span><span class="s">&#34;application/json&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//A previous Async request retrieved our access token, now we&#39;re appending it to the header</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;Authorization&#34;</span><span class="p">,</span> <span class="s">&#34;Bearer &#34;</span> <span class="p">+</span> <span class="n">task</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//make request</span>
</span></span><span class="line"><span class="cl">    <span class="kt">string</span> <span class="n">userId</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">taskUser</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">GetAsync</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">taskUser</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">taskUser</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">taskUser</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="n">taskUser</span><span class="p">.</span><span class="n">Result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">taskUserExists</span><span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">taskUserExists</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">taskUserExists</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//Converting the results to an object we can consume in C#, this is done by creating a class that matches the JSON</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">user</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">(</span><span class="n">taskUserExists</span><span class="p">.</span><span class="n">Result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="k">value</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="c1">//User exists so save the userId to add it to the unified group</span>
</span></span><span class="line"><span class="cl">                  <span class="n">userId</span> <span class="p">=</span> <span class="n">user</span><span class="p">.</span><span class="k">value</span><span class="err">\</span><span class="p">[</span><span class="m">0</span><span class="err">\</span><span class="p">].</span><span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="c1">//CODE TO CREATE INVITATION GOES HERE</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">userId</span> <span class="p">!=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//CODE TO ADD USER TO UNIFIED GROUP GOES HERE - Adding Users to the Unified Group</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>If you’ve verified that the user account doesn’t exist, then you will want to create an invitation for them to join. Luckily the Microsoft Graph has a great way to do this for you called <a href="https://learn.microsoft.com/en-us/graph/api/resources/invitation?view=graph-rest-1.0">Invitation Manager</a>. Depending on how much control you want over the email that goes to guests you can set the <strong>sendInvitationMessage</strong> property to allow Microsoft to send the email for you with a couple of configurable properties or you can take the information returned from the invitation process to craft and send your own email.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">urlGraph</span> <span class="p">=</span> <span class="s">&#34;https://graph.microsoft.com/v1.0/invitations&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//User doesn&#39;t exist, create invitation</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StringContent</span><span class="p">(</span><span class="s">@&#34;{
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;invitedUserEmailAddress&#39;: &#39;my\_email@extdomain.com&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;inviteRedirectUrl&#39;: &#39;https://myTenant.sharepoint.com/sites/MyExternalSite&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;invitedUserDisplayName&#39;: &#39;My User (extdomain)&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;sendInvitationMessage&#39;: &#39;true&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#39;invitedUserMessageInfo&#39;: {
</span></span></span><span class="line"><span class="cl"><span class="s">        &#39;ccRecipients&#39;: \[{
</span></span></span><span class="line"><span class="cl"><span class="s">            &#39;emailAddress&#39;: {
</span></span></span><span class="line"><span class="cl"><span class="s">                &#39;address&#39;: &#39;ccRecipient@myTenant.com&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">                &#39;name&#39;: &#39;CC Recipient&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">            }
</span></span></span><span class="line"><span class="cl"><span class="s">        }\]
</span></span></span><span class="line"><span class="cl"><span class="s">    }
</span></span></span><span class="line"><span class="cl"><span class="s">}&#34;</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">&#34;application/json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">taskNewUser</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">PostAsync</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">,</span> <span class="n">content</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">taskNewUser</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">taskNewUser</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">taskNewUser</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">Created</span> <span class="p">||</span> <span class="n">taskNewUser</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">HttpResponseMessage</span> <span class="n">responseNewUser</span> <span class="p">=</span> <span class="n">taskNewUser</span><span class="p">.</span><span class="n">Result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">taskNewUserContent</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">responseNewUser</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">taskNewUserContent</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">taskNewUserContent</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">userNew</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">(</span><span class="n">taskNewUserContent</span><span class="p">.</span><span class="n">Result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">userNew</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">userId</span> <span class="p">=</span> <span class="n">userNew</span><span class="p">.</span><span class="n">invitedUser</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//At this point the user exists in AAD and can be modified further.</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">taskNewUser</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The return payload from that post, gives you the AAD id for the user that will be used in the next step but that you can also then be used to modify the users account more, by setting other properties like mobile phone, company, and maybe even uploading a photo or setting a manager relationship. For more information on modifying a user record see the <a href="https://learn.microsoft.com/en-us/graph/api/resources/users?view=graph-rest-1.0">Graph documentation for a User</a>.</p>
<h3 id="adding-users-to-the-unified-group">Adding Users to the Unified Group</h3>
<p>So, either from the results of creating an invitation or from looking the user up you have the AAD Id that can be used to add that user to the members group of the Unified Group. This is as easy as making a post to the <em>group/{id}/members</em> endpoint. The code below goes in outlined in the first code snippet in the section Creating External Users.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">//Add to Group</span>
</span></span><span class="line"><span class="cl"><span class="n">urlGraph</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;https://graph.microsoft.com/v1.0/groups/{0}/members/$ref&#34;</span><span class="p">,</span> <span class="n">groupId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">contentGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StringContent</span><span class="p">(</span><span class="s">@&#34;{&#39;@odata.id&#39;: &#39;https://graph.microsoft.com/v1.0/users/&#34;</span> <span class="p">+</span> <span class="n">userId</span> <span class="p">+</span> <span class="s">@&#34;&#39;}&#34;</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">&#34;application/json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">taskResultGroup</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">PostAsync</span><span class="p">(</span><span class="n">urlGraph</span><span class="p">,</span> <span class="n">contentGroup</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">taskResultGroup</span><span class="p">.</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">taskResultGroup</span><span class="p">.</span><span class="n">Result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">taskResultGroup</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">NoContent</span> <span class="p">||</span> <span class="n">taskResultGroup</span><span class="p">.</span><span class="n">Result</span><span class="p">.</span><span class="n">StatusCode</span> <span class="p">==</span> <span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Success&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&#34;Failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="summary">Summary</h2>
<p>By taking these ideas and your own requirements and imagination you can assemble a very powerful tool to manage your companies external sharing. Luckily for us the Microsoft Graph allows us to attain most the capabilities we need and in time, probably all. I hope this helps get you started. Happy Coding!</p>

  </article>

      
    
    <div class="jt-pager">
      
        <button class="hoo-button" title="Harvesting your SharePoint Site Collections" onclick="jtBlogMain.navigate('https:\/\/juliemturner.net\/post\/harvesting-sharepoint-sites\/')" > 
          <span class="hoo-icon">
            <svg class="hoo-icon-svg icon-arrow-left" aria-hidden="true">
              <use xlink:href="/icons.svg#icon-arrow-left"></use>
            </svg>
          </span>
          <span class="hoo-button-label">Previous Post</span>      
        </button>
      
      
        <button class="hoo-button is-reversed" title="Tip: Implementing &#39;Nav&#39; Office Fabric UI React Component" onclick="jtBlogMain.navigate('https:\/\/juliemturner.net\/post\/nav-officeui-fabric-component\/')">
          <span class="hoo-icon">
            <svg class="hoo-icon-svg icon-arrow-right" aria-hidden="true">
              <use xlink:href="/icons.svg#icon-arrow-right"></use>
            </svg>
          </span>
          <span class="hoo-button-label">Next Post</span>
        </button>
      
    </div>
  

  
    
      
      <div class="jt-disqus-comments">                  
        <button onclick="jtBlogMain.showComments(event, 'veni-vidi-vici-1')">
          Show 
          <span class="disqus-comment-count" data-disqus-url="https://juliemturner.net/post/managing-unifed-group/">comments</span>
        </button>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_config = function () {
          this.page.url = 'https:\/\/juliemturner.net\/post\/managing-unifed-group';
        };
      </script>
      </div>
      
    
  
</div>

    </article>
    <aside class="jt-sidebar">
      

  <div class="jt-asideSection">
    
<h2>Share this post</h2>

<ul class="hoo-meta-list">
  
  <li>
    <a class="hoo-mtag" href="//twitter.com/share?url=https%3a%2f%2fjuliemturner.net%2fpost%2fmanaging-unifed-group%2f&amp;text=Managing%20the%20Unified%20Group%20in%20Office%20365%20for%20SharePoint%20and%20Beyond&amp;via=jfj1997"
      target="_blank" title="Share on Twitter">
      <i class="fab fa-twitter jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjuliemturner.net%2fpost%2fmanaging-unifed-group%2f" target="_blank" title="Share on Facebook">
      <i class="fab fa-facebook jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//reddit.com/submit?url=https%3a%2f%2fjuliemturner.net%2fpost%2fmanaging-unifed-group%2f&amp;title=Managing%20the%20Unified%20Group%20in%20Office%20365%20for%20SharePoint%20and%20Beyond" target="_blank" title="Share on Reddit">
      <i class="fab fa-reddit jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fjuliemturner.net%2fpost%2fmanaging-unifed-group%2f&amp;title=Managing%20the%20Unified%20Group%20in%20Office%20365%20for%20SharePoint%20and%20Beyond" target="_blank"
      title="Share on LinkedIn">
      <i class="fab fa-linkedin jt-mtag-icon"></i>
    </a>
  </li>

  
  <li>
    <a class="hoo-mtag" href="//toot.kytta.dev/?text=Check%20out%20this%20article%20Managing%20the%20Unified%20Group%20in%20Office%20365%20for%20SharePoint%20and%20Beyond%20at%20https%3a%2f%2fjuliemturner.net%2fpost%2fmanaging-unifed-group%2f" target="_blank"
      title="Share on Mastodon">
      <i class="fab fa-mastodon jt-mtag-icon"></i>
    </a>
  </li>
</ul>

  </div>




  <div class="jt-asideSection">
    <h2>Tags</h2>
    <ul class="hoo-meta-list">
  
  <li>
    <a class="hoo-mtag" href="/tags/sharepoint/" aria-label="View all posts tagged with 'SharePoint'">
      <span class="hoo-mtag-lbl">SharePoint</span>
    </a>
  </li>
  
  <li>
    <a class="hoo-mtag" href="/tags/microsoft-365/" aria-label="View all posts tagged with 'Microsoft 365'">
      <span class="hoo-mtag-lbl">Microsoft 365</span>
    </a>
  </li>
  
  <li>
    <a class="hoo-mtag" href="/tags/c-sharp/" aria-label="View all posts tagged with 'C#'">
      <span class="hoo-mtag-lbl">C#</span>
    </a>
  </li>
  
</ul>
  </div>


  
    
  
  
    <div class="jt-asideSection">
      <h2>See also</h2>
      <ul class="symp-list">
      
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/htwoo-210-dialogs/">hTWOo-React 2.1.0 Spotlight: Dialogs</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/better-practices-console-log-pnpjs/">Console Log Better Practices with PnPjs V3</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/intro-htwoo-react/">Intro to hTWOo-React: Microsoft Fluent UI React alternative</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/getting-started-pnpjs/">Getting Started with PnPjs</a></li>
      
        <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="/post/sp-appcatalog-dev-tips/">SharePoint App Catalog Development Tips</a></li>
      
      </ul>
    </div>
  

<div class="jt-asideSection">
  <h2>About the Author</h2>
  <div class="jt-aside-headshot">
    <img src="https://juliemturner.net/img/jturner.png" alt="Julie Turner headshot" />
  </div>
  <div class="jt-highlight">Julie Turner</div>
  <div class="jt-subhighlight">Partner/CTO</div>
  <div class="jt-subhighlight">
    <a href="https://sympraxisconsulting.com" target="_blank">
      <div class="symp-logo"></div>
    </a>
  </div>
  <div class="jt-listcont">
    <ul class="symp-list">
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span>Microsoft MVP since 2017</li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://pnp.github.io/" target="_blank">Microsoft 365 PnP Team member since 2019</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://pnp.github.io/pnpjs/" target="_blank">PnPjs maintainer</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://lab.n8d.studio/htwoo/" target="_blank">HTWOO maintainer</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://sympraxisconsulting.com/portfolio/clouddev-clarity/" target="_blank">CloudDev Clarity co-host</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://officedev.github.io/browser-native/" target="_blank">Browser Native co-host</a></li>
      <li><span class="sympstar">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
    <path class="st0"
      d="M33.9,35.1L50,19c-1.7,0.6-3.4,1-5.2,1c-3.6,0-7.1-1.3-9.7-3.7L18.9,0.1c0.6,1.6,1,3.4,1,5.2
	c0,3.6-1.3,7-3.7,9.7l-0.1,0.1l0,0l-8.6,8.6l-3.6,3.7L0,31.2c1.7-0.6,3.4-1,5.2-1c3.4,0,6.7,1.2,9.2,3.3c0.2,0.2,0.4,0.4,0.6,0.6
	l1.1,1.1l0.1,0.1L19,38l4.5,4.5l3.6,3.6L28,47l2.9,2.9c-0.6-1.7-1-3.4-1-5.1c0-3.4,1.2-6.8,3.3-9.3C33.5,35.5,33.7,35.3,33.9,35.1z" />
  </svg>
</span><a href="https://sympraxisconsulting.com/ask-sympraxis/" target="_blank">Ask Sympraxis Bi-Weekly Videocast</a></li>
    </ul>
  </div>
</div>

  <div class="jt-asideSection">
  <h2>Join Me Live</h2>
   
    
    
   
    
    
   
    
    
   
    
    
   
    
    
  
</div>


    </aside>
    <footer class="footer">
      
        <ul class="hoo-meta-list">
          
          <li>
            
              <a href="mailto:julie.turner@sympraxisconsulting.com"
                title="Email me">
                
                <span class="fa-stack fa-lg">
                  <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://github.com/juliemturner"
                title="GitHub">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://twitter.com/jfj1997"
                title="Twitter">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://linkedin.com/in/juliemturner"
                title="LinkedIn">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
              <a href="https://www.youtube.com/user/username"
                title="Youtube">
                
                <span class="fa-stack fa-lg">
                  <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          <li>
            
            <a rel="me"href="#ZgotmplZ"
              title="Mastodon">
              
                <span class="fa-stack fa-lg">
                  <i class="fab fa-mastodon fa-stack-1x fa-inverse"></i>
                </span>
              </a>
          </li>
          
            
          
        </ul>
        <p class="jt-copyright">
          &nbsp;&copy;
          2011 - 2023
          Julie Turner ~ All rights reserved
        </p>


<script src="https://juliemturner.net/js/solid.min.js"></script>
<script src="https://juliemturner.net/js/brands.min.js"></script>
<script src="https://juliemturner.net/js/fontawesome.min.js"></script>

<script src="https://juliemturner.net/js/main.js"></script>





<script id="dsq-count-scr" src="//veni-vidi-vici-1.disqus.com/count.js" async></script>


      
    </footer>
  </div>
</body>

</html>